Fortigate firewall Quick Integration Guide
==========================================
:encoding: UTF-8
:lang: en
:doctype: book

include::includes/global-attributes.asciidoc[]

About this Guide
----------------
This guide has been created in order to help sales engineers, product managers, or network specialists demonstrate the PacketFence capabilities on-site with an existing or potential customer.  It can also provide guidelines to setup a proof of concept for a potential PacketFence deployment using the Fortigate firewall.

Assumptions
-----------
* You have a configured PacketFence environment with working test equipment
* You have a Fortigate firewall.


Quick installation
------------------
Step 1: Configuration of the RSSO Agent
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Go to your Fortigate administration webpage in *User & Device -> User -> User Groups -> Create New*.

[options="compact"]
* *Name: RSSO_group
* *Type: RADIUS Single Sign-On (RSSO)
* *RADIUS Attribute Value: RSSO_Student (Put the rolename of PacketFence, it's case sensitive)

image::docs/images/doc-fortigate-SSO_Role.png[scaledwidth="100%",alt="Create the SSO agent in Fortigate"]

You can also see that in the webpage at *User & Device -> Monitor -> Firewall*

Step 2: Activate the Accounting Listening
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Go to *System -> Network -> Interfaces*

Select the interface that will communicate with PacketFence and check : Listen for RADIUS Accounting Messages than validate by OK.

image::docs/images/doc-fortigate-SSO_accouting.png[scaledwidth="100%",alt="Configure the accouting listening in the Fortigate"]

Step 3: SSO Configuration in PacketFence
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Go to *Configuration -> Firewall SSO -> Add Firewall -> FortiGate*

[options="compact"]
* *Hostname or IP Address: @IP of your firewall
* *Firewall type: Fortigate (Fortigate = Accounting request; Fortigate = XML request)
* *Secret or Key: secret (radius shared secret)
* *Port: 1813
* *Roles: add the roles that you want to do SSO

image::docs/images/doc-fortigate-SSO_Role_pf.png[scaledwidth="100%",alt="Configure the Fortigate SSO in PacketFence"]

Step 4: Verification
~~~~~~~~~~~~~~~~~~~

If you want to see if it's working, you can log into the firewall over SSH and run these following commands:

[options="compact"]
* *di debug enable
* *di debug application radiusd -1
